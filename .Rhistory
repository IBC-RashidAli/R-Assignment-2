setwd("C:/Users/r.ali/Desktop/Rashid_Khi_Assignment2_R")
write.csv("CleanDataHospital.csv")
dst <- read.csv("hospitaldata.csv"
,strip.white = T, na.strings = c("-",""," ","\t","\n",NA), stringsAsFactors = F)
dataf <- tbl_df(dst)
library(lubridate)
library(dplyr)
library(tidyr)
dataf <- tbl_df(dst)
library(lubridate)
library(dplyr)
library(tidyr)
dst <- read.csv("hospitaldata.csv"
,strip.white = T, na.strings = c("-",""," ","\t","\n",NA), stringsAsFactors = F)
dataf <- tbl_df(dst)
names(dataf) <- gsub("\\.","",names(dataf))
View(dataf)
dataf$Date <- mdy(dataf$Date)
wday(dataf$Date[which(table(dataf$Date) == max(table(dataf$Date)))],label=T,abbr=F)
dataf$Age <- parse_number(dataf$Age)
mean(dataf$Age,na.rm = T)
library(readr)
dst <- read.csv("hospitaldata.csv"
,strip.white = T, na.strings = c("-",""," ","\t","\n",NA), stringsAsFactors = F)
dataf <- tbl_df(dst)
names(dataf) <- gsub("\\.","",names(dataf))
View(dataf)
dataf$Date <- mdy(dataf$Date)
wday(dataf$Date[which(table(dataf$Date) == max(table(dataf$Date)))],label=T,abbr=F)
dataf$Age <- parse_number(dataf$Age)
mean(dataf$Age,na.rm = T)
tot_child <- dataf %>%
select(Age) %>%
filter(Age >= 1 & Age <= 12, !is.na(.)) %>%
count()
dataf %>%
group_by(Sex, Procedure) %>%
count(sort = TRUE) %>%
filter(!is.na(Sex)) %>%
View()
dataf$TotalCharges <- as.numeric(gsub("cancelled", NA, ignore.case = T,dataf$TotalCharges))
hst_earn_doc <-  dataf %>%
group_by(ConsultingDoctor) %>%
summarise_each(funs(sum(TotalCharges, na.rm = T))) %>%
select(ConsultingDoctor, TotalCharges) %>%
arrange(desc(TotalCharges))
(hst_earn_doc$ConsultingDoctor[which(hst_earn_doc$TotalCharges==max(hst_earn_doc$TotalCharges))])
dataf$Procedure <- (gsub("cancelled", NA, ignore.case = T,dataf$Procedure))
hst_earn_proc <-  dataf %>%
group_by(Procedure) %>%
summarise_each(funs(sum(TotalCharges, na.rm = T))) %>%
select(Procedure, TotalCharges) %>%
filter(!is.na(Procedure)) %>%
arrange(desc(TotalCharges))
(hst_earn_proc$Procedure[which(hst_earn_proc$TotalCharges==max(hst_earn_proc$TotalCharges))])
hft <-  dataf %>%
filter(!is.na(Date), !is.na(Time)) %>%
group_by(Date,Time) %>%
count() %>%
arrange(desc(n))
dataf %>%
mutate(TimeBracket = ifelse(hour(strptime(dataf$Time, "%I:%M %p")) >= 6 & hour(strptime(dataf$Time, "%I:%M %p")) <= 12, "Morning",
ifelse(hour(strptime(dataf$Time, "%I:%M %p")) > 12 & hour(strptime(dataf$Time, "%I:%M %p")) <= 16, "Afternoon",
ifelse(hour(strptime(dataf$Time, "%I:%M %p")) > 16 & hour(strptime(dataf$Time, "%I:%M %p")) <= 19, "Evening",
ifelse(hour(strptime(dataf$Time, "%I:%M %p")) > 19, "Night", NA))))) %>%
View()
RP_vist <-  dataf %>%
group_by(id) %>%
count() %>%
filter(n > 1) %>%
arrange(desc(n))%>%
print
print(RP_vist$id)
RP_Pt  <-  dataf %>%
group_by(id, Procedure) %>%
count() %>%
filter(!is.na(Procedure), n > 1) %>%
arrange(desc(n))
med_f_m<- dataf %>%
group_by(toupper(Sex)) %>%
summarize(median(Age, na.rm = T))
dataf$AmountBalance <- as.numeric(gsub(",",'',dataf$AmountBalance) )
sum(dataf$AmountBalance, na.rm = T)
dataf %>%
group_by(Procedure) %>%
summarise(Total_Amount = sum(TotalCharges, na.rm = T)) %>%
filter(Procedure = c("Consultation"))
dataf %>%
group_by(Procedure) %>%
summarise(Total_Amount = sum(TotalCharges, na.rm = T)) %>%
filter(Procedure == c("Consultation"))
dt <- dataf %>%
filter(!is.na(Age), !is.na(TotalCharges))
cor( dt$TotalCharges,dt$Age)
highest_age_visit <- dataf %>%
group_by(Age) %>%
tally() %>%
filter(!is.na(Age)) %>%
arrange(desc(n))
highest_age_visit$Age[which(highest_age_visit$n==max(highest_age_visit$n))]
TotEarn <- dataf %>%
filter(Procedure == c("X Ray", "Scalling")) %>%
summarise(Total = sum(TotalCharges, na.rm = T))
write.csv("CleanData.csv")
write.csv(dataf, "CleanData.csv")
